---
title: "R Notebook"
output: html_notebook
---

# TP1 


## Récupération des données
```{r}
# install.packages("RPostgreSQL")
require("RPostgreSQL")
 
# create a connection
pw <- "YojCqLr3Cnlw6onuzHU3"
 
# loads the PostgreSQL driver
drv <- dbDriver("PostgreSQL")
# creates a connection to the postgres database
# note that "con" will be used later in each connection to the database
con <- dbConnect(drv, dbname = "postgres",
                 host = "database-1.c5bqsgv9tnea.eu-west-3.rds.amazonaws.com", port = 5432,
                 user = "postgres", password = pw)
rm(pw) # removes the password

dbExistsTable(con, "flight")
```


On récupère les données
```{r}
df_flight <- dbGetQuery(con, "SELECT * FROM flight limit 10000")
```


## Calcul du nombre de vols par mois

```{r}
df_count = data.frame(year=integer(),
                 month=integer(), 
                 count=integer())

for (i in 1:nrow(df_flight)) {
  flight <- df_flight[i,]
  if(flight$month  %in% filter(df_count, year == flight$year)$month) {
      df_count$count[df_count$year==flight$year & df_count$month==flight$month ] = df_count$count[df_count$year==flight$year & df_count$month==flight$month ] +1
    }else {
       df_count[nrow(df_count) + 1,]= c(flight$year,flight$month, 1)
    }
}
```




## Nombre de siège moyen sur 3 mois glissant

```{r}
df_mean = data.frame(year=integer(),
                 month=integer(), 
                 count=integer())

df_flight <- df_flight %>% 
                        group_by (year, month) %>%
                        arrange( year, month) 
```

